{% extends "_base.html" %}

{% block content %}

<h1><strong>{{ episode.code}}</strong> {{ episode.title }}</h1>
<p>Originally aired {{ episode.run_date.strftime('%A, %B %e, %Y') }}.</p>
<p>Watched by {{ episode.rating }} million viewers.</p>

<h2>All {{ episodejokes|length }} recurring jokes in this episode:</h2>
<ul>{% for ej in episodejokes %}
    <li>
        <a href="joke-{{ ej.joke.code }}.html">
            <strong>{{ ej.joke.primary_character.strip() }}</strong> {{ ej.joke.text.strip() }}
        </a>
        {% if ej.details != None %}
            <span class="extra details">
                {{ ej.details.replace("/", "</span><span class='extra details'>")|safe }}
            </span>
        {% endif %}
        {% if ej.connections() != [] %}{% for joke in ej.connections() %}
            <span class="extra connection">
                <a href="{{ joke.url }}">
                    <strong>{{ joke.primary_character }}</strong>
                    {{ joke.text }}
                </a>
            </span>
        {% endfor %}{% endif %}
    </li>
{% endfor %}</ul>
{% endblock %}